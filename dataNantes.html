<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<title>Parking Publics Nantes</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
</head>
<body>
	<style type="text/css">
		.w3-card {
  			box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
  			transition: 0.3s;
		}
		.w3-card:hover {
  			box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
		}
		.container {
  			padding: 2px 16px;
		}

		.search-container button {
  			padding: 6px 10px;
  			margin-top: 8px;
  			margin-right: 16px;
  			background: #ddd;
  			font-size: 17px;
  			border: none;
  			cursor: pointer;
		}

		.search-container button:hover {
  			background: #ccc;
		}
	</style>
	
	<div id="demo">
		<h1>Parkings Public Nantes</h1>
		<div class="search-container">
			<input type="text" placeholder="Search..">
			<button type="submit">Rechercher</button>
		</div>
		<ul>
	    	<li v-for="record in records">
	    		<div class="w3-card">
					<div class=container style="padding: 2px 16px;">
	    				<p>Lieu: <span class="grp_nom">{{record.fields.grp_nom}}</span></p>
	    				<p><span class="grp_disponible">{{record.fields.grp_disponible}}</span>/<span class="grp_exploitation">{{record.fields.grp_exploitation}}</span></p>
	    				<p><span></span></p>
	    			</div>
				</div>	
	    	</li>
	    </ul>	
	</div>

	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  	<script>
  		var apiURL = 'https://data.nantesmetropole.fr/api/records/1.0/search/?dataset=244400404_parkings-publics-nantes-disponibilites&facet=grp_nom&facet=grp_statut&facet=grp_disponible'
  		var config = {
  			headers:{'Authorization': "bearer"+ 'c59e66c66a22dd8424e7c64a8e44b101828266d516b9c133f85eb7ad'}
  		}

  		var demo = new Vue({

		  el: '#demo',

		  data: {
		    branches: ['master', 'dev'],
		    currentBranch: 'master',
		    records: []
		  },

		  created: function () {
		    this.fetchData()
		  },

		  watch: {
		    currentBranch: 'fetchData'
		  },

		  filters: {
		    truncate: function (v) {
		      var newline = v.indexOf('\n')
		      return newline > 0 ? v.slice(0, newline) : v
		    },
		    formatDate: function (v) {
		      return v.replace(/T|Z/g, ' ')
		    }
		  },

		  methods: {
		    fetchData: function () {
		    	var self = this
		    	axios.get(apiURL, config)
		    		.then(function(response){
		    			console.log(response)
		    			self.records = response.data.records
		    			console.log(self.records[0].html_url);
		    		})
		    		.catch(function(error){
		    			console.log(error);
		    		})
		  		}
		  	}
		})
  	</script>
</body>
</html>